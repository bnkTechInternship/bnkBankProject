<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <title>Document</title>
    <link rel = "stylesheet" href = "css/main.css">
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src = "script/main.js"></script>
    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=59b7bde77496d4668dfdddc31a4207fc"></script>
</head>
<body>

    <!-- topnavbar start -->  
    <div id="container">
        <div id="topNavbar">
            <div id="topNavbar__one">
                <img src = "img/bnk핫플5.png" id = "logo">
                <div id = "topInputDiv">
                    <input type = "text">
                </div>
                <div id = "myInfo">
                    <img src = "img/more.png">
                    <img src = "img/user.png">
                </div>
            </div>            
        </div> 
        <!-- topnavbar end -->  

        
        <!-- topNavbar2 start -->
        <div id="topNavbar2" class = "top">
            <div id = "itemContainer">
                <a href = "#" class = "item" id = "1" onclick = "showBank()">
                    <img src = "img/bank.png"/>
                    <span>은행</span>
                </a>
                <a href = "#" class = "item" id = "default2" onclick = "showMarket()">
                    <img src = "img/restaurant.png"/>
                    <span>맛집</span>
                </a>
                <a href = "#" class = "item" id = "3">
                    <img src = "img/eiffel-tower.png"/>
                    <span>관광지</span>
                </a>
                <a href = "#" class = "item" id = "4">
                    <img src = "img/information.png"/>
                    <span>홈페이지 정보</span>
                </a>
            </div>
        </div>
        <!-- topNavbar2 end -->


        <!-- switch button start -->
        <div id="switch">지도로 보기</div>
        <!-- switch button end-->


        <!-- map start -->
        <div id= "map">

        </div>
        <!-- map end -->


        <!-- content start -->
        <div id = "content" class = "middle block">
            <!-- <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Facilis nobis provident aut impedit deserunt iure dolorum maxime, incidunt quae a aspernatur libero odio similique odit, dolor ea perferendis repellendus aliquid.</p> -->
            <div class="content__item">
                <div class = "content__item__img">
                    <img src = "img/고메부산1.jpg">
                </div>
                <div class = "content__item__info">
                    <h3>가게이름</h3>
                    <div>★ 4.9</div>
                    <div>♥ 1.2만</div>
                    <div>평균가격 : ₩35,000</div>
                </div>
            </div>
            <div class="content__item">
                <div class = "content__item__img">
                    <img src = "img/고메부산2.jpg">
                </div>
                <div class = "content__item__info">
                    <h3>가게이름</h3>
                    <div>★ 4.9</div>
                    <div>♥ 1.2만</div>
                    <div>평균가격 : ₩35,000</div>
                </div>
            </div>
            <div class="content__item">
                <div class = "content__item__img">
                    <img src = "img/고메부산3.jpg">
                </div>
                <div class = "content__item__info">
                    <h3>가게이름</h3>
                    <div>★ 4.9</div>
                    <div>♥ 1.2만</div>
                    <div>평균가격 : ₩35,000</div>
                </div>
            </div>
            <div class="content__item">
                <div class = "content__item__img">
                    <img src = "img/고메부산4.jpg">
                </div>
                <div class = "content__item__info">
                    <h3>가게이름</h3>
                    <div>★ 4.9</div>
                    <div>♥ 1.2만</div>
                    <div>평균가격 : ₩35,000</div>
                </div>
            </div>
            <div class="content__item">
                <div class = "content__item__img">
                    <img src = "img/고메부산5.jpg">
                </div>
                <div class = "content__item__info">
                    <h3>가게이름</h3>
                    <div>★ 4.9</div>
                    <div>♥ 1.2만</div>
                    <div>평균가격 : ₩35,000</div>
                </div>
            </div>
            <div class="content__item">
                <div class = "content__item__img">
                    <img src = "img/고메부산6.jpg">
                </div>
                <div class = "content__item__info">
                    <h3>가게이름</h3>
                    <div>★ 4.9</div>
                    <div>♥ 1.2만</div>
                    <div>평균가격 : ₩35,000</div>
                </div>
            </div>
           
        </div>
        <!-- content end -->

    </div>

    <!-- kakaoMap API Script -->
    <script>

        if(navigator.geolocation) {
            
            navigator.geolocation.getCurrentPosition(function(position) {
                let arr = [];
                // 위치를 가져오는데 성공할 경우
                $.each(position.coords, function(key, item) {
                    arr[key] = item;
                });
    
                var moveLatLon = new kakao.maps.LatLng(arr['latitude'],arr['longitude']);
                map.setCenter(moveLatLon);
            }, function(error) {
                
                // 위치를 가져오는데 실패한 경우
                console.log(error.message);
                console.log('위치를 찾지 못했습니다. 기본 좌표는 부산은행 연수원입니다.')
            });
        } else {
            consol.log("Geolocation을 지원하지 않는 브라우저 입니다.");
        }


        var markers = [];

    let marketInfo = [
        {lat : 35.1542163,	lng : 129.0671883, name : '탱글'},
        {lat : 35.1857483,	lng : 129.2134797, name : '모닝베어'},
        {lat : 35.1979343,	lng : 129.0638297, name : '카츠무이'},
        {lat : 35.1799061,	lng : 129.2006147, name : '누들누들찹찹'},
        {lat : 35.0697622,	lng : 129.0827214, name : '티엔미미블랙'},
        {lat : 35.1531826,	lng : 129.1246887, name : '샤브남바완'},
        {lat : 35.2031659,	lng : 129.0834478, name : '카츠텐시'},
        {lat : 35.2086058,	lng : 129.008308 , name : '멘테네'},
        {lat : 35.1444519,	lng : 129.0598773, name : '진영곱창'},
        {lat : 35.1555094,	lng : 129.0671459, name : '귀족호랑이'},
        {lat : 35.150113,	lng : 29.1150777,  name : '라벨라치타'},
        {lat : 35.1697042,	lng : 129.1145039, name : '팔도해물칼국수'},
        {lat : 35.1575601,	lng : 129.1258114, name : '퍼프버거스탑'},
        {lat : 35.1616913,	lng : 129.1673799, name : '소공간'},
        {lat : 35.238017,	lng : 29.0856228,  name : '흥안양꼬지'},
        {lat : 35.2327118,	lng : 129.0882373, name : '애프터워크'},
        {lat : 35.1014293,	lng : 129.0312503, name : '풍악'},
        {lat : 35.1234693,	lng : 129.0415831, name : '초량온당'},
        {lat : 35.1134984,	lng : 129.0203513, name : '웨스트사이드'},
        {lat : 35.1280831,	lng : 128.9764615, name : '맨투데이코어'}]

    let bankInfo = [
    {lat : 35.2450186,	lng : 129.2150875, name :'부산은행 기장지점' },
    {lat : 35.2481162,	lng : 129.2155198, name :'부산은행 일광지점' },
    {lat : 35.2308957,	lng : 129.1575853, name :'부산은행 반송운봉영업소' },
    {lat : 35.2263793,	lng : 129.1486755, name :'부산은행 반송동지점' },
    {lat : 35.1688241,	lng : 129.1784467, name :'부산은행 장산지점' },
    {lat : 35.1769654,	lng : 129.1729869, name :'부산은행 좌동지점' },
    {lat : 35.1781311,	lng : 129.1221012, name :'부산은행 센텀파크영업소' },
    {lat : 35.214874,	lng : 129.1056597 ,name :'부산은행 금사공단지점'},
    {lat : 35.1671161,	lng : 129.1334887, name :'부산은행 벡스코지점' },
    {lat : 35.1384264,	lng : 129.0598263, name :'부산은행 범일동지점' },
    {lat : 35.24667,	lng : 129.0885389, name :'부산은행 구서동금융센터'},
    {lat : 35.1972988,	lng : 129.0603999, name :'부산은행 사직운동장지점' },
    {lat : 35.1728173,	lng : 129.0716064, name :'부산은행 양정동지점' },
    {lat : 35.1194931,	lng : 129.1122715, name :'부산은행 용호동지점' },
    {lat : 35.1838,	    lng : 129.1074,    name :'부산은행 토곡지점'},
    {lat : 35.1986217,	lng : 129.0976136, name :'부산은행 안락동지점' },
    {lat : 35.1400604,	lng : 129.1063519, name :'부산은행 남천동지점' },
    {lat : 35.1942925,	lng : 129.0985305, name :'부산은행 연안영업소' },
    {lat : 35.1752,	    lng : 129.054,     name :'부산은행 초읍동지점' }]


    var mapContainer = document.getElementById('map'),  // 맵 div받기
        mapOption = { 
            center: new kakao.maps.LatLng(35.1542163, 129.0671883), // 지도 중심좌표
            level: 3 // 지도의 확대 레벨
        };

        var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성

        // 맨처음 default로 맛집 마커 및 내용 생성
        for(let i = 0 ; i < marketInfo.length; i++) {
            var infowindow = new kakao.maps.InfoWindow({
                content: marketInfo[i].name // 인포윈도우에 표시할 내용
            });
            addMarker(new kakao.maps.LatLng(marketInfo[i].lat, marketInfo[i].lng),infowindow)
        }

        function addMarker(position, infoWindow) {
        
            // 마커를 생성
            var marker = new kakao.maps.Marker({
                position: position
            });
        
            // 마커가 지도 위에 표시되도록 설정합니다
            marker.setMap(map);
            
            // 생성된 마커를 배열에 추가합니다
            markers.push(marker);

            kakao.maps.event.addListener(marker, 'mouseover', makeOverListener(map, marker, infoWindow));
            kakao.maps.event.addListener(marker, 'mouseout', makeOutListener(infoWindow));
            
        }

        // 배열에 추가된 마커들을 지도에 표시하거나 삭제하는 함수입니다
        function setMarkers(map) {
            for (var i = 0; i < markers.length; i++) {
                markers[i].setMap(map);
            }            
        }

        // "마커 보이기" 버튼을 클릭하면 호출되어 배열에 추가된 마커를 지도에 표시하는 함수입니다
        function showMarkers() {
            setMarkers(map)    
        }

        // "마커 감추기" 버튼을 클릭하면 호출되어 배열에 추가된 마커를 지도에서 삭제하는 함수입니다
        function hideMarkers() {
            setMarkers(null);    
        }

        function showMarket() {
            hideMarkers();
            for(let i = 0 ; i < marketInfo.length; i++) {
                var infowindow = new kakao.maps.InfoWindow({
                    content: marketInfo[i].name // 인포윈도우에 표시할 내용
                });

                addMarker(new kakao.maps.LatLng(marketInfo[i].lat, marketInfo[i].lng),infowindow)
            }
        }

        function showBank() {
            hideMarkers();
            for(let i = 0 ; i < bankInfo.length; i++) {
                var infowindow = new kakao.maps.InfoWindow({
                    content: bankInfo[i].name // 인포윈도우에 표시할 내용
                });

                addMarker(new kakao.maps.LatLng(bankInfo[i].lat, bankInfo[i].lng),infowindow)
            }
        }

        // info열기
        function makeOverListener(map, marker, infowindow) {
            return function() {
                infowindow.open(map, marker);
            };
        }

        // info닫기
        function makeOutListener(infowindow) {
            return function() {
                infowindow.close();
            };
        }
    </script>
</body>
</html>